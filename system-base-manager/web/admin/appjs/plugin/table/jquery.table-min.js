var MaxTable=function(){this.page=new Pages();this.defaultSortInfo={columnId:"id",fieldName:"id",sortOrder:"desc"};this.sortInfo=this.defaultSortInfo;this.showPageInfo=true;this.table=null};MaxTable.prototype={initialize:function(a){this.opts=$.extend({id:"id",showPageInfo:true},a||{});this._s=$("#"+this.opts.table)[0];this.loading=$("#"+this.opts.loading);if(this.opts.isSort==false){this.sortInfo=null}this.showPageInfo=this.opts.showPageInfo;this.complete=this.opts.complete;this.table=this.opts.table},onLoad:function(d){this.searchParameters=d;var c=this.opts;var e=this._s;var b=c.queryUrl;var f=this;if(f.loading){$(f.loading).block({message:"数据加载中...",css:{width:"70%"}})}$.ajax({type:"POST",url:c.queryUrl,data:this.getQueryData(d),dataType:"json",success:function(g){try{var n=g.data;f.page=g.pageInfo;while(e.rows.length>0){e.deleteRow(0)}if(n.length==0){var m=e.insertRow(0);m.id="page";var l=m.insertCell(0);l.colSpan=c.headerColumns.length;l.innerHTML="没有记录！"}else{var p=n.length;for(var k=0;k<n.length;k++){var m=e.insertRow(e.rows.length);m.id=k+1;if(k%2==0){m.className="td1"}else{m.className="td2"}for(var h=0;h<c.headerColumns.length;h++){var l=m.insertCell(h);if(c.headerColumns[h].renderer){l.innerHTML=c.headerColumns[h].renderer(n[k][c.id],n[k][c.headerColumns[h].id],n[k])}else{l.innerHTML=n[k][c.headerColumns[h].id]}}}if(f.page.totalRowNum!=0){var m=e.insertRow(e.rows.length);m.id="page";var l=m.insertCell(0);l.colSpan=c.headerColumns.length;l.innerHTML=f.createPage(f.page);$("#pageSize",l).bind("blur",function(){var i=/^\d{1,}$/;if(!i.test(this.value)){alert("分页只能是数字！");return}if(parseInt(this.value)<=0){alert("分页数字不正确！");return}f.page.pageSize=this.value;f.page.totalRowNum=-1;f.query()});$("#firstPage",l).bind("click",function(){f.page.pageNum=1;f.query()});$("#prePage",l).bind("click",function(){f.page.pageNum=f.page.pageNum-1;f.query()});$("#nextPage",l).bind("click",function(){f.page.pageNum=f.page.pageNum+1;f.query()});$("#lastPage",l).bind("click",function(){f.page.pageNum=f.page.totalPageNum;f.query()});$("#Pg",l).bind("blur",function(){var i=/^\d{1,}$/;if(!i.test(this.value)){alert("分页只能是数字！");return}if(parseInt(this.value)<=0){alert("分页数字不正确！");return}f.page.pageNum=this.value;f.query()})}}f.loading.unblock();f.complete=true}catch(o){if(response.responseText.indexOf("loginwindow")!=-1){parent.location.reload()}else{alert(response.responseText)}}if(f.complete){$("#"+f.table+" tr").mouseover(function(){if($(this).attr("id")!="page"){$(this).addClass("over")}}).mouseout(function(){if($(this).attr("id")!="page"){$(this).removeClass("over")}})}},error:function(g){if(g!=null&&g!=undefined&&g.responseText.length>0){if(g.responseText.indexOf("loginwindow")!=-1){parent.location.reload()}else{alert(g.responseText)}}}});var a=$('input[name="c_all"]')[0]+"";$('input[name="c_all"]').attr("checked",false);if(a!="undefined"){$('input[name="c_all"]')[0].nextSibling.nodeValue="全选"}},createPage:function(a){var b="";b+='每页显示<input id="pageSize"   value="'+a.pageSize+'" type="text" id="pageSize"   style="width:20px; border:solid #CCC 1px"/>';b+="条&nbsp;|&nbsp;共<font color=red>"+a.totalPageNum+"</font>页 , <font color=red>"+a.totalRowNum+"</font>条数据";b+="&nbsp;|&nbsp;";b+='<input id="firstPage"  type="button" '+(a.pageNum>1?' style="background:#FFF ; border:none;cursor:pointer"  ':' disabled="disabled" ')+'   name="button" id="button" value="首页"  style="background:#FFF ; border:none;"/>&nbsp;';b+='<input id="prePage"  type="button" '+(a.pageNum>1?'  style="background:#FFF ; border:none;cursor:pointer" ':' disabled="disabled" ')+'   name="button" id="button" value="上一页"  style="background:#FFF ; border:none;"/>&nbsp;';b+='<input id="nextPage"  type="button" '+(a.totalPageNum>a.pageNum?' style="background:#FFF ; border:none;cursor:pointer"  ':' disabled="disabled" ')+'   name="button" id="button" value="下一页"  style="background:#FFF ; border:none;"/>&nbsp;';b+='<input id="lastPage"  type="button"  '+(a.totalPageNum>a.pageNum?' style="background:#FFF ; border:none;cursor:pointer"  ':' disabled="disabled" ')+'  name="button" id="button" value="尾页"  style="background:#FFF ; border:none;"/>&nbsp;';b+='&nbsp;|&nbsp;第<input id="Pg"   value="'+a.pageNum+'" type="text" id="Pg" style="width:20px; border:solid #CCC 1px"/>页';return b},getQueryData:function(b){if(!this.showPageInfo){this.page.pageSize=100}var a={_gt_json:"{pageInfo:"+$.toJSON(this.page)+",action:'load',filterInfo:[],sortInfo:["+(this.sortInfo==null?"":$.toJSON(this.sortInfo))+"]}"};a=$.extend(a,b);return a},query:function(){this.onLoad(this.searchParameters)},initSortHead:function(c){var e=this;var b=$("#"+c.head)[0];this.headInfos=new Array();for(var a=0;a<c.cells.length;a++){var f=c.cells[a].name;var d=document.createElement("span");d.innerHTML="&nbsp;&nbsp;&nbsp;&nbsp;";$(b.cells[c.cells[a].index]).append(d);this.headInfos[this.headInfos.length]={index:c.cells[a].index,name:c.cells[a].name,sortSpan:d};$(b.cells[c.cells[a].index]).bind("click",function(){e.setSortInfo(this.cellIndex);e.page.pageNum=1;e.query()})}},setSortInfo:function(a){for(var b=0;b<this.headInfos.length;b++){var d=this.headInfos[b].name;var c=this.headInfos[b].sortSpan;if(a==this.headInfos[b].index){if(!this.sortInfo){this.sortInfo={columnId:d,fieldName:d,sortOrder:"desc"};c.className="sortDesc"}else{if(this.sortInfo.fieldName==d){if(this.sortInfo.sortOrder==""){c.className="sortDesc";this.sortInfo={columnId:d,fieldName:d,sortOrder:"desc"}}else{if(this.sortInfo.sortOrder=="desc"){c.className="sortAsc";this.sortInfo={columnId:d,fieldName:d,sortOrder:"asc"}}else{c.className="";this.sortInfo=this.defaultSortInfo}}}else{c.className="sortDesc";this.sortInfo={columnId:d,fieldName:d,sortOrder:"desc"}}}}else{c.className=""}}}};function Pages(){this.endRowNum=-1;this.pageNum=1;this.startRowNum=1;this.totalPageNum=0;this.totalRowNum=-1;this.pageSize=17}function IdCheckBoxRenderer(a,b){return'<input type="checkbox" name="c"	value="'+b+'"">'}function IdRadioRenderer(a,b){return'<input type="radio" name="c"	value="'+b+'"">'}function numRenderer(b,d,a,c){return(c+1)}function getCheckedValuesByContainer(b,c){var a="input[name="+b+"]:checked";var d=new Array();var e=$(a,c);if(e){e.each(function(){d.push($(this).val())})}return d};