// Copyright (c) Microsoft Corporation.  All rights reserved.
registerNamespace=function(b){var rootObject=window;var namespaceParts=b.split(".");var iCount=namespaceParts.length;for(var i=0;i<iCount;i++){var currentPart=namespaceParts[i];if(!rootObject[currentPart])rootObject[currentPart]={};rootObject=rootObject[currentPart];}};var Mail={};var WebLight={"Browser":{},"UI":{},"Conversion":{}};WebLight.Browser._isIE=window.navigator.userAgent.indexOf("MSIE ")>0;WebLight.Browser.isIE=function(){return WebLight.Browser._isIE;};if(WebLight.Browser._isIE)WebLight.Browser.Button={"LEFT":1,"RIGHT":2,"MIDDLE":4};else WebLight.Browser.Button={"LEFT":0,"RIGHT":2,"MIDDLE":1};WebLight.UI.getLocation=function(e,g){if(!e)return WebLight.UI.Rect.Empty;var c=new WebLight.UI.Rect();c.source=e;var s=e.currentStyle;var marg=new Array("Top","Left","Right","Bottom");for(var i=0;i<marg.length;i++){var m=marg[i];c["margin"+m]=WebLight.Conversion.coerceInt(s["margin"+m]);c["border"+m]=WebLight.Conversion.coerceInt(s["border"+m+"Width"]);c["padding"+m]=WebLight.Conversion.coerceInt(s["padding"+m]);}c.height=e.offsetHeight;c.width=e.offsetWidth;c.left=e.offsetLeft;c.top=e.offsetTop;e=e.offsetParent;var m_root=WebLight.UI.getLayoutRoot();while(e&&(!g||e!=g)){c.left+=e.offsetLeft-(m_root!=e?WebLight.Conversion.coerceInt(e.scrollLeft):0);c.top+=e.offsetTop-(m_root!=e?WebLight.Conversion.coerceInt(e.scrollTop):0);e=e.offsetParent;}if(document.compatMode=="CSS1Compat"){c.contentWidth=c.source.offsetWidth-c.borderLeft-c.borderRight-c.paddingLeft-c.paddingRight-c.marginLeft-c.marginRight;c.contentHeight=c.source.offsetHeight-c.borderTop-c.borderBottom-c.paddingTop-c.paddingBottom-c.marginTop-c.marginBottom;}else{c.contentWidth=c.source.offsetWidth;c.contentHeight=c.source.offsetHeight;}c.x=c.left;c.y=c.top;c.bottom=c.top+c.height-c.marginBottom;c.right=c.left+c.width-c.marginRight;return c;};WebLight.UI.Rect=function(x,y,w,h){return {"left":x,"x":x,"top":y,"y":y,"width":w,"height":h,"right":x+w,"bottom":y+h,"equals":function(r){return this.x==r.x&&this.y==r.y&&this.width==r.width&&this.height==r.height;},"inflate":function(h,j){this.width+=h;this.height+=j;this.right=this.x+this.width;this.bottom=this.y+this.height;},"offset":function(x,y){this.x+=x;this.left=this.x;this.y+=y;this.top=this.y;this.right+=x;this.bottom+=y;},"isEmpty":function(){return this.width<=0||this.height<=0;},"contains":function(p){return p.x>=this.left&&p.x<=this.width+this.left&&p.y>=this.top&&p.y<=this.height+this.top;}};};WebLight.UI.Rect.Empty=new WebLight.UI.Rect(0,0,0,0);WebLight.Conversion={"coerceInt":function(k){k=parseInt(k);return isNaN(k)?0:k;}};WebLight.UI.getLayoutRoot=function(){return document.compatMode=="CSS1Compat"?document.documentElement:document.body;};function prototypeObservable(l){l.prototype.attachEvent=function(m,n){if(!this._handlers)this._handlers=new Object();if(!this._handlers[m])this._handlers[m]=new Array();this._handlers[m].push(n);};l.prototype.detachEvent=function(o,p){try{for(var i=0;i<this._handlers[o].length;i++){if(this._handlers[o][i]==p)break;}this._handlers[o].splice(i,1);if(!this._handlers[o].length)this._handlers[o]=null;}catch(e){}};l.prototype.fire=function(q){if(this._handlers)for(var i=0;this._handlers[q]&&i<this._handlers[q].length;i++){this._handlers[q][i](this);}};}String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"");};String.prototype.format=function(){var s=this;var aRE=String.prototype.format.aRegExp;var iCount=arguments.length;for(var i=0;i<iCount;i++){if(!aRE[i])aRE[i]=new RegExp("\\{"+i+"\\}","g");s=s.replace(aRE[i],arguments[i]);}return s;};String.prototype.format.aRegExp=[];String.prototype.removeSpaceDelimitedString=function(r){var s=" "+this.trim()+" ";return s.replace(" "+r+" "," ").trim();};String.prototype.encodeURI=function(){return encodeURI(this).replace(/'/g,"%27");};function TabSelect(r){var srcElement=r.srcElement;if(srcElement.tagName=="A")srcElement=srcElement.parentElement;else{if(srcElement.tagName=="DIV")srcElement=srcElement.parentElement.parentElement;}var tabHeaderSelectedClass="TabHeaderSelected";var tabHeaderUnselectedClass="TabHeaderUnselected";var tabContentSelectedClass="TabContentSelected";var tabContentUnselectedClass="TabContentUnselected";if(srcElement.className!=tabHeaderSelectedClass){var MsnTodayTab=document.getElementById("MsnTodayTab");var MsnTodayHeader=document.getElementById("MsnTodayHeader");var RecentUpdatesTab=document.getElementById("RecentUpdatesTab");var RecentUpdatesHeader=document.getElementById("RecentUpdatesHeader");if(srcElement==MsnTodayHeader){if(RecentUpdatesHeader!=null){RecentUpdatesTab.className=tabContentUnselectedClass;RecentUpdatesHeader.className=tabHeaderUnselectedClass;}if(MsnTodayHeader!=null){MsnTodayTab.className=tabContentSelectedClass;MsnTodayHeader.className=tabHeaderSelectedClass;}}else{if(srcElement==RecentUpdatesHeader){if(RecentUpdatesHeader!=null){RecentUpdatesTab.className=tabContentSelectedClass;RecentUpdatesHeader.className=tabHeaderSelectedClass;}if(MsnTodayHeader!=null){MsnTodayTab.className=tabContentUnselectedClass;MsnTodayHeader.className=tabHeaderUnselectedClass;}}}}r.returnValue=false;r.cancelBubble=true;}function addClass(s){var classes;if(s.className)classes=s.className.split(" ");else classes=new Array();var len=arguments.length;for(var i=1;i<len;i++){var op=arguments[i].slice(0,1);var cls=arguments[i].slice(1);var idx=inArray(cls,classes);if(op=="-"){if(idx!=-1){if(typeof Array.splice!="undefined")classes.splice(idx,1);else classes=arrayDeleteElemAt(classes,idx);}}else{if(idx==-1){if(typeof Array.push!="undefined")classes.push(cls);else arrayPushElem(classes,cls);}}}var newClass=classes.join(" ");if(s.className!=newClass)s.className=newClass;}function arrayPushElem(t,u){t[t.length]=u;}function arrayDeleteElemAt(v,w){if(w<0||w>=v.length)return;var returnArray=new Array();for(var i=0;i<v.length;++i){if(i!=w)returnArray[returnArray.length]=v[i];}return returnArray;}function todayPage_ev_viewContact(x){window.location="ContactViewLight.aspx?ContactID="+x;}function todayPage_ev_addContact(){window.location="ContactEditLight.aspx";}function todayPage_ev_expandContacts(y){addClass(getElem("ContactsModuleList"),(y?"-":"+")+"NotExpanded");addClass(getElem("SpacesModuleList"),(y?"-":"+")+"NotExpanded");}function isClassPresent(z,A){var rgClasses=z.className.split(" ");return inArray(A,rgClasses)>=0;}function inArray(B,C){var len=C.length;for(var i=0;i<len;i++){if(C[i]==B)return i;}return -1;}function blockEnter(){if(event.keyCode==13&&event.returnValue!=1)return false;}function DoHelp(D){if(!(typeof D==="string")){if(typeof g_helpKey==="string")D=g_helpKey;else D="PIM_WhatsNew";}try{LaunchHelp(g_helpBaseUrl,g_helpPaneProject,g_helpPaneMarket,"HelpPane.aspx","keyword",D,false,"b1","","","");}catch(ex){}}function hover(E){if(E.className=="ListItem dIndexListHover")E.className="ListItem";else{if(E.className=="ListItem")E.className="ListItem dIndexListHover";}}function fhover(F){if(F.className.indexOf("FolderItemHover")>=0)F.className=F.className.replace("FolderItemHover ","");else F.className="FolderItemHover "+F.className;}function onSubmitToolbarItemClicked(G,H){if(G=="PrintMessages"&&CheckAndPrintOneMsg())return;var actionItem=document.getElementById("ToolbarActionItem");var actionForm=document.getElementById(g_wlmMainFormId);if(H!=null&&H.length>0)actionForm.action=H;actionItem.value=G;actionForm.submit();}function onSubmitInfoPaneItemClicked(I){var actionItem=document.getElementById("InfoPaneActionItem");var actionForm=document.getElementById(g_wlmMainFormId);actionItem.value=I;actionForm.submit();}function DropdownAction(J,K,L,M){var selectMoveTo=document.getElementById(J);if(selectMoveTo.value!=""){if(selectMoveTo.value==K)window.location.href=L;else{if(M=="")onSubmitToolbarItemClicked(selectMoveTo.id);else window.location.href=M+"="+selectMoveTo.value;}}}function listItemSelected(N){var srcElement=N.srcElement;if(srcElement.tagName=="LI")window.location.href=srcElement.childNodes[0].href;}function showBlockingNotify(O,P,Q,R,S){var hasYes=P!=null&&P.length>0;var hasNo=Q!=null&&Q.length>0;if(hasYes||hasNo){var isUrl=R!=null&&R.length>0;var action=confirm(O)?P:Q;if(action!=null&&action.length>0){if(isUrl){if(R=="_blank")window.setTimeout("window.open('"+action+"', '"+R+"').focus()",200);else window.open(action,R);}else{if(S)onSubmitInfoPaneItemClicked(action);else onSubmitToolbarItemClicked(action,null);}}}else alert(O);}function maybeShowBlockingNotify(){if(typeof g_showBlockingNotify!="undefined"&&g_showBlockingNotify){g_showBlockingNotify=false;showBlockingNotify(g_blockingNotifyMsg,g_blockingNotifyYes,g_blockingNotifyNo,g_blockingNotifyTarget,g_blockingNotifyFromInfoPane);}}String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"");};getCookie=function(T){var cookies=document.cookie.split(";");var len=cookies.length;for(var i=0;i<len;i++){var currCookie=cookies[i];var equals=currCookie.indexOf("=");if(equals!=-1){var name=currCookie.substring(0,equals).trim();if(name==T)return currCookie.substring(equals+1,currCookie.length).trim();}}return null;};insertCanary=function(){var mt=document.getElementById("mt");if(mt)mt.value=getCookie("mt");};function onScriptLightLoaded(){insertCanary();maybeShowBlockingNotify();}onScriptLightLoaded();function searchLive(U){var sQuery;if(isClassPresent(document.body,"Contacts"))sQuery=document.getElementById("SearchContactsBox").value;else sQuery=document.getElementById("SearchEmailBox").value;window.open(U+"&q="+encodeURIComponent(sQuery).replace(/'/g,"%27")+"&FORM=WLMLQB");}